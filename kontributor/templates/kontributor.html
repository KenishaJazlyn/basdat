{% extends 'base.html' %}
{% load static %}

{% block meta %}
<head>
    <link href='https://fonts.googleapis.com/css?family=Playfair Display' rel='stylesheet'>
    <title>Daftar Kontributor</title>
    <style>
        .page-title{
            text-align: center;
            margin-top: 20px;
            margin-bottom: 20px;
            font-family: Roboto;
            font-size: 20pt;
        }
        .list-kontributor{
            border-collapse: collapse;
            width: 100%;    
            font-family:Roboto;      
            border-radius: 15px;
            overflow:hidden;
            box-shadow: 4px 4px 7px #cd0711;
              
        }
        .list-kontributor th,
        .list-kontributor td {
            border: 0.5px solid black;
            padding: 8px;
            text-align: center;
        }
        .list-kontributor thead {
            background-color: #ba0b14;
            color:#f2f2f2;
            font-size: 15pt;
        }
        .list-kontributor tbody {
            background-color: #f2f2f2;
            color:#91A3B0;
            font-size: 12pt;
        }
        select {
            background-color: #ba0b14;
            color: #91A3B0;
            padding: 8px;
            border: none;
            border-radius: 5px;
            font-size: 12pt;
        }
        select:hover {
            background-color: #a00a12;
        }
    </style>
</head>
{% endblock meta %}

{% block content %}
<body>
    <h1 class="page-title">Daftar Kontributor</h1>
    <table class="list-kontributor">
        <thead>
            <tr>
              <th>Nama</th>
              <th>Tipe: 
                <select id="tipe" name="tipe">
                    <option value="0">Semua</option>
                    <option value="1">Sutradara</option>
                    <option value="2">Pemain</option>
                    <option value="3">Penulis Skenario</option>
                </select>
            </th>
              <th>Jenis Kelamin</th>
              <th>Kewarganegaraan</th>
            </tr>
        </thead>
        <tbody id="contributor_table">
            
        </tbody>
    </table>
</body>

<script>
    async function getContributor() {
        return fetch("{% url 'kontributor:get_kontributor' 0 %}".replace(/0/, document.getElementById("tipe").value))
            .then((res) => res.json())
    }

    async function refreshContributor() {
        document.getElementById("contributor_table").innerHTML = "<tr><th colspan='4'>Loading</th></tr>";
        let htmlString = ``;
        const contributor = await getContributor();
        let index = 0;
        // console.log(contributor);
        while (contributor.length != index) {
            item = contributor[index]
            htmlString += `\n<tr>
                            <th>${item.nama}</th>
                            <th>${item.tipe}</th>
                            <th>${item.jenis_kelamin}</th>
                            <th>${item.kewarganegaraan}</th>
                        </tr>`;
            index++;
        }
        document.getElementById("contributor_table").innerHTML = htmlString;
    }

    document.addEventListener("DOMContentLoaded", function() {
        document.getElementById("tipe").onchange = function() {
            refreshContributor();
        };
    });
    refreshContributor();
</script>
{% endblock content %}